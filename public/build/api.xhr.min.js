/* 2016-06-02 / !function(a,b){"use strict";return"undefined"!=typeof b&&b===window&&"XMLHttpRequest"in b?(b.api||(b.api={}),void(b.api.xhr=a(b))):!1}(function(a,b){"use strict";var c=function(c){var d,e,f,g,h,i,j,k,c=c||{},l={contentType:"application/x-www-form-urlencoded",type:"GET",url:"",async:!0,data:{},context:a,dataType:"text",progressUpload:b,progressDownload:b,beforeSend:b,complete:b,success:b},m=[];for(k in l)l.hasOwnProperty(k)&&(l[k]=c[k]);if(/[^get|post|put|delete]/i.test(l.type))return!1;if("string"!=typeof l.url||""===l.url.replace(/\s/g,""))return!1;if("boolean"!=typeof l.async)return!1;if(a.FormData&&"object"==typeof l.data&&l.data instanceof FormData)j=l.data,l.contentType=null;else{if("string"==typeof l.data&&""!==l.data)l.data.replace(/([^=&]+)=([^&]*)/g,function(a,b,c){m.push(b+"="+c)});else if("object"==typeof l.data&&Object.keys(l.data).length>0)for(i in l.data)l.data.hasOwnProperty(i)&&m.push(i+"="+l.data[i]);j=m.join("&")}if("get"===l.type.toLowerCase()&&(l.url+=l.url.lastIndexOf("?")>-1?"&"+j:"?"+j,l.contentType=null),"string"==typeof l.dataType&&"jsonp"===l.dataType.toLowerCase())d=l.url.match(/[?&]callback=([^&]*)?/),e=d?d[1]:"YSM_"+Math.round(1e4*Math.random()),window[e]=function(a){l.success.call(l.context,a)},f=new RegExp("\\b(callback=).*?(&|$)"),0<=l.url.search(f)?l.url=l.url.replace(f,"$1"+e+"$2"):l.url=l.url+(l.url.indexOf("?")>0?"&":"?")+"callback="+e,g=window.document.createElement("script"),g.src=l.url,document.getElementsByTagName("head")[0].appendChild(g),g.onload=g.onreadystatechange=function(){g.readyState&&!/loaded|complete/.test(g.readyState)||(g.onload=g.onreadystatechange=null,g.parentNode&&g.parentNode.removeChild(g))};else{if(h=new XMLHttpRequest,"undefined"==typeof h.withCredentials)return!1;h.open(l.type,l.url,l.async),h.setRequestHeader("Accept","*/*"),h.setRequestHeader("X-Requested-With","XMLHttpRequest"),l.contentType&&h.setRequestHeader("Content-Type",l.contentType),l.dataType&&(h.responseType=l.dataType),h.upload.onprogress=function(a){var b=a.total||0,c=a.loaded||0;b&&c&&"function"==typeof l.progressUpload&&l.progressUpload.call(l.context,Number(100/b*c).toFixed(2))},h.onprogress=function(a){var b=a.total||0,c=a.loaded||0;b&&c&&"function"==typeof l.progressDownload&&l.progressDownload.call(l.context,Number(100/b*c).toFixed(2))},h.onreadystatechange=function(){switch(h.readyState){case 0:"function"==typeof l.beforeSend&&l.beforeSend.call(l.context);break;case 1:case 2:break;case 3:"function"==typeof l.complete&&l.complete.call(l.context);break;case 4:200!==h.status}},h.onload=function(a){if(200==h.status){var b=h.response||h.responseText||h.responseXML;h.responseType||"json"!==l.dataType.toLowerCase()||(b=JSON.parse(b)),"function"==typeof l.success&&l.success.call(l.context,b)}},h.onerror=function(a){console.log("error"),console.log(a)},h.send(j||null)}};return c},this);